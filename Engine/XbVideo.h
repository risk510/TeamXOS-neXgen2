/*

		PATCH XBOX VIDEO MODE

*/


#ifndef XBVIDEO_H
#define XBVIDEO_H


#include <xtl.h>

typedef enum
{
	COUNTRY_NULL,
	COUNTRY_USA,
	COUNTRY_JAP,
	COUNTRY_EUR
} F_COUNTRY;

typedef enum
{
	VIDEO_NULL,
	VIDEO_NTSCM,
	VIDEO_NTSCJ,
	VIDEO_PAL50,
	VIDEO_PAL60
} F_VIDEO;

extern	"C"	int		__stdcall	MmQueryAddressProtect(void *Adr);
extern	"C"	void	__stdcall	MmSetAddressProtect(void *Adr, int Size, int Type);

static	BYTE	OriginalData[57]=
{
	0x55,0x8B,0xEC,0x81,0xEC,0x04,0x01,0x00,0x00,0x8B,0x45,0x08,0x3D,0x04,0x01,0x00,
	0x00,0x53,0x75,0x32,0x8B,0x4D,0x18,0x85,0xC9,0x6A,0x04,0x58,0x74,0x02,0x89,0x01,
	0x39,0x45,0x14,0x73,0x0A,0xB8,0x23,0x00,0x00,0xC0,0xE9,0x59,0x01,0x00,0x00,0x8B,
	0x4D,0x0C,0x89,0x01,0x8B,0x45,0x10,0x8B,0x0D
};

static	BYTE	PatchData[70]=
{
	0x55,0x8B,0xEC,0xB9,0x04,0x01,0x00,0x00,0x2B,0xE1,0x8B,0x45,0x08,0x53,0x3B,0xC1,
	0x74,0x0C,0x49,0x3B,0xC1,0x75,0x2F,0xB8,0x00,0x03,0x80,0x00,0xEB,0x05,0xB8,0x04,
	0x00,0x00,0x00,0x50,0x8B,0x4D,0x18,0x6A,0x04,0x58,0x85,0xC9,0x74,0x02,0x89,0x01,
	0x8B,0x4D,0x0C,0x89,0x01,0x59,0x8B,0x45,0x10,0x89,0x08,0x33,0xC0,0x5B,0xC9,0xC2,
	0x14,0x00,0x00,0x00,0x00,0x00
};

F_COUNTRY GetAutoPatchCountry(char* xbefile);
F_VIDEO GetAutoPatchVideo(char* xbefile);
bool PatchCountryVideo(F_COUNTRY Country, F_VIDEO Video);


#endif